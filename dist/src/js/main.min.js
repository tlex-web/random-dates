class DateError extends Error{constructor(e,t){super(e),this.field=t}}let monthNumberFromString=e=>new Date(`${e} 01 2000`).toLocaleDateString("en",{month:"2-digit"});const getRandomInteger=(e,t)=>Math.floor(Math.random()*(t-e))+e;class RandomDateSampler{constructor(e,t,r,n,o){this._start=0!==e.value.length?new Date(String(e.value)):void 0,this._end=0!==t.value.length?new Date(String(t.value)):void 0,this._batchSize=+r.value,this._weekend=!!n.checked,this._errorFields=o,this._batch=[],this._output=[],this._isError=!1}get error(){return this._isError}checkInput=()=>{if(!this._start)throw new DateError("Provide a date",0);if(!this._end)throw new DateError("Provide a date",1);if(this._start.valueOf()>this._end.valueOf())throw new DateError(`${this._end.toString().slice(0,10)} needs to be greater than ${this._start.toString().slice(0,10)}`,[0,1]);if(+this._start==+this._end)throw new DateError("Define a valid range",[0,1]);if(this._batchSize<=0)throw new DateError("Sample needs to be greater than 0",2);if(this.getDatesInRange(new Date(this._start),new Date(this._end),this._weekend).length<this._batchSize)throw new DateError("Extend the time frame or pick a lower sample size",[0,1,2,3])};init(){try{this.checkInput(),this._isError=!1}catch(e){const{message:t,field:r}=e;if("object"==typeof r)this._isError=!0,r.forEach((e=>{this._errorFields[+e].innerHTML=t}));else{this._isError=!0;const e=+r;this._errorFields[e].innerHTML=t}}return!this._isError}print(){return[this._start,this._end,this._weekend,this._batchSize]}getDatesInRange=(e,t,r)=>{if("object"!=typeof e)throw new Error("DateType");if("object"!=typeof t)throw new Error("DateType");const n=[];for(let o=new Date(e);o<=new Date(t);o.setDate(o.getDate()+1))r?"Sat"!==o.toString().slice(0,3)&&"Sun"!==o.toString().slice(0,3)&&n.push(new Date(o)):n.push(new Date(o));if(!n?.length)throw new DateError("Couldn't create batch",2);return n};createRandomSampleBatch=(e,t)=>{let r=[],n=[],o=e.length;for(let s=1;s<=o;++s){const s=(a=0,i=o,Math.floor(Math.random()*(i-a))+a);if(n.includes(s)||r.push(e[s]),r.length===t)break;n.push(s)}var a,i;if(r.length!==t)throw new DateError("Extend the time frame or pick a lower sample size",2);return r};createOutput=()=>{let e=[];try{const t=this.getDatesInRange(new Date(this._start),new Date(this._end),this._weekend);e=this.createRandomSampleBatch(t,this._batchSize)}catch(e){const{message:t,field:r}=e;this._isError=!0,this._errorFields[+r].innerHTML=t}const t=[];return e.forEach((e=>{let r=`${e.toString().slice(8,10)}/${monthNumberFromString(e.toString().slice(4,8))}/${e.toString().slice(11,16)}`;t.push(`<li>${r}</li>`)})),{html_output:t,dates:e}}}const form=document.querySelector("form"),outputList=document.querySelector(".output-list"),submitBtn=document.querySelector('button[type="submit"]'),clipboard=document.querySelector("#clipboard"),txt=document.querySelector("#txt"),csv=document.querySelector("#csv"),outputField=document.querySelectorAll(".hidden"),errorFields=document.querySelectorAll(".error");form.addEventListener("submit",(e=>{e.preventDefault();const{startDate:t,endDate:r,batchSize:n,weekend:o}=e.target,a=new RandomDateSampler(t,r,n,o,errorFields);if(!a.init())return;const{html_output:i,dates:s}=a.createOutput();a.error&&location.reload(),a.error&&s?.length||outputField.forEach((e=>{e.classList.contains("hidden")&&e.classList.remove("hidden")})),outputList.innerHTML=i.join(" ");const c=s.map((e=>`${e.toString().slice(8,10)}/${monthNumberFromString(e.toString().slice(4,8))}/${e.toString().slice(11,16)}`));clipboard.addEventListener("click",(async e=>{e.preventDefault(),await navigator.clipboard.writeText(c.join(" ,").replaceAll(" ,","")),clipboard.innerHTML="Copied to clipboard"})),txt.addEventListener("click",(async e=>{e.preventDefault(),saveDataAsTXT("random_dates.txt",c.join(" ,").replaceAll(" ,",""))})),csv.addEventListener("click",(async e=>{e.preventDefault(),saveDataAsCSV("random_dates.csv",c.join(" ,").replaceAll(" ,",";"))}))}));const saveDataAsTXT=(e,t)=>{const r=new Blob([t],{type:"text/plain;charset=utf-8"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,e);else{const t=window.document.createElement("a");t.href=window.URL.createObjectURL(r,{oneTimeOnly:!0}),t.download=e,t.click(),URL.revokeObjectURL(t.href)}},saveDataAsCSV=(e,t)=>{const r=new Blob([t],{type:"text/csv;charset=utf-8"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(r,e);else{const t=window.document.createElement("a");t.href=window.URL.createObjectURL(r,{oneTimeOnly:!0}),t.download=e,t.click(),URL.revokeObjectURL(t.href)}},saveDataAsXlsx=e=>{const t=new Blob([function(e){const t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t!=e.length;++t)r[t]=255&e.charCodeAt(t);return t}(atob(e))],{type:""});href=URL.createObjectURL(t)};